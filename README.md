<div align="center">
  <img src="docs/images/mock.png" alt="트립티케 메인 이미지" width="100%">
  
  <br/>

🔗 [트립티케 바로가기](https://triptyche.world)

</div>

---

## 📸 About 트립티케 (TripTyche)

트립티케는 **여행 사진 속 메타데이터를 활용해 실제 여행했던 경로를 자동으로 생성**하고, **친구들과 실시간으로 공유**할 수 있는 여행 기록 서비스입니다.

단순히 여행 사진을 저장하는 것이 아닌 **캐릭터가 실제 경로를 따라 움직이며 실제 여행을 재현**하고, **보딩패스 스타일의 여행 티켓**으로 추억을 저장할 수 있습니다.

Safari/iOS의 HEIC부터 JPG까지 **모든 이미지 형식을 지원**합니다.

---

## ✨ 핵심 기능

- 📍 이미지 메타데이터(위치, 날짜) 자동 추출 및 최적화
- 🗺️ Google Maps API 기반 여행 경로 시각화 및 하버사인 알고리즘을 활용한 위치 클러스터링
- 🚶 커스텀 애니메이션과 상태관리를 통한 인터렉티브 캐릭터 애니메이션
- 📱 위치/날짜 기반 여행 사진 갤러리

|                                                기능                                                |                                          기능                                           |
| :------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------: |
|                             ![위치추출](docs/images/image-upload.gif)                              |                         ![타임라인](/docs/images/timeline.gif)                          |
| **자동 위치 정보 추출** <br/> 메타데이터(위치, 날짜) 추출 및 리사이징, WebP 변환으로 이미지 최적화 | **인터랙티브 타임라인** <br/> 군집화된 여행 경로를 따라 움직이는 캐릭터 애니메이션 제공 |
|                        ![위치별 이미지](docs/images/image-by-pinpoint.gif)                         |                    ![날짜별 이미지](/docs/images/image-by-date.gif)                     |
|        **위치별 이미지 슬라이드쇼** <br/> 핀포인트에 해당하는 이미지 슬라이드쇼 형식 갤러리        |             **날짜별 듀얼뷰** <br/> 시간순으로 정렬된 날짜별 이미지 갤러리              |
|                             ![클러스터링](docs/images/clustering.gif)                              |                                                                                         |
|    **동적 클러스터링** <br/> Google Maps Clusterer를 활용한 줌 레벨 기반 동적 이미지 클러스터링    |                                                                                         |

---

## 🛠️ 기술 스택

### Frontend

React 18, TypeScript, Zustand, Tanstack Query (React Query), Emotion (CSS-in-JS), StompJS (WebSocket)

### Backend

Spring Boot, JPA, MySQL, Redis, JWT, OAuth2, JUnit5

### Infrastructure

Nginx, Docker, AWS EC2, AWS S3, GitHub Actions, Grafana, K6

### External API

Google Maps API (지도 및 클러스터링)

---

## 🏗️ 아키텍처

### 1. 도메인 중심 아키텍처로의 리팩토링

기존 `components/`, `hooks/` 등 기술별 구조에서 **비즈니스 도메인 중심**으로 리팩토링했습니다.

**🚫 기존 문제점**

1. 관련 파일 탐색/삭제 시 여러 폴더를 오가야 함
2. 기능 수정 시 흩어진 코드로 인한 유지보수성 저하

**✅ 해결 방안**

각 도메인 내부에서 `components/`, `hooks/`, `types/` 등 관련 코드를 **한 곳에서 독립적으로 관리할 수 있도록 구조를 통합**했습니다.

```
src/
├── domains/                   # 비즈니스 도메인 중심 폴더 구조
│ ├── media/                   # 이미지 관련
│ ├── trip/                    # 여행 생성, 수정, 조회
│ ├── route/                   # 지도 기반 경로 표시
│ ├── share/                   # 여행 공유 및 공동 작업 기능
│ ├── user                     # 사용자 인증 및 설정
│ └── notification/            # 실시간 알림
│
├── shared/                    # 공통 UI, 훅, 스타일, 상수, 타입 등
├── libs/                      # API 클라이언트, WebSocket, 유틸 함수 등
├── layouts/                   # 전체 앱 레이아웃 컴포넌트
├── router/                    # 라우팅 설정
├── pages/                     # 서비스 페이지
└── assets/                    # 이미지, 폰트 등 정적 자원
```

😃 구조 설계부터 리팩토링, 유지보수까지의 전 과정을 **직접 주도하며 반복 개선**하면서, **기능 단위 사고와 설계 역량**을 키울 수 있었습니다.

### 2. 레이어 기반 단방향 데이터 흐름으로 분리

관심사 분리를 통해 **각 5단계의 레이어**가 명확한 책임을 갖도록 설계했습니다.

각 레이어는 명확한 책임을 가지며, 의존성은 단방향으로 흐릅니다.

```
HTTP 클라이언트 → 도메인 API → Result 변환 유틸함수 → TanStack Query 훅 → UI 컴포넌트
```

---

### 주요 기술적 특징

- [**Result 패턴**: 타입 안전한 에러 핸들링으로 일관된 사용자 경험 제공](./docs/result-pattern.md)
- **도메인 중심 구조**: 기능별 응집도 향상으로 유지보수성 개선

---

## 💻 주요 기술적 구현

### 이미지 메타데이터 처리

- EXIF 데이터에서 위치 정보(GPS) 및 시간 정보 추출
- 위치 정보가 없는 이미지는 구글 맵에서 수동 선택 지원
- 이미지 리사이징 및 최적화 처리

### 위치 기반 클러스터링

- 1km 반경 내 사진들을 하나의 포인트로 군집화
- 구글 맵 API를 활용한 마커 클러스터링 구현
- 시간순 정렬로 여행 경로 시각화

### 동적 맵 클러스터링

- Google Maps Clustering API를 활용한 동적 군집화
- 줌 레벨에 따른 자동 클러스터링 조정
- 줌 레벨 17 이상에서 개별 이미지 포인트 표시
- 각 포인트별 포토카드 인터랙션 제공

## 💡 핵심 기술적 구현

### 🖼️ 다형식 이미지 처리 파이프라인

```iOS HEIC 형식 지원 및 완전 자동화된 이미지 최적화
HEIC/JPG → 형식 감지 → HEIC→JPG 변환 → 메타데이터 추출 → 리사이징/압축 → WebP 변환 → S3 업로드
```

- 다중 형식 지원: heic2any로 iOS HEIC 형식을 JPG로 변환 후 처리
- 바이너리 수준 형식 감지: 파일 헤더 분석으로 실제 이미지 형식 정확히 판별
- 3단계 최적화: exif.js 메타데이터 추출 → browser-compression 리사이징/압축 → WebP 변환
- 스트리밍 업로드: Presigned URL을 활용한 대용량 이미지 병렬 S3 업로드

### 🗺️ 지능형 위치 클러스터링

- Google Maps Clustering API: 줌 레벨별 동적 포인트 군집화 연동
- 하버사인 거리 계산: 1km 반경 내 사진들을 하나의 여행 포인트로 군집화
- 시간순 경로 생성: 촬영 시간 기반 자동 여행 경로 최적화

### ⚡ WebSocket 기반 실시간 협업

- STOMP 프로토콜: Spring Boot와 연동된 안정적인 실시간 통신 구현
- 상태 동기화: 여러 사용자의 동시 편집을 위한 실시간 상태 브로드캐스팅
